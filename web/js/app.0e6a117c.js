(function(t){function e(e){for(var o,n,r=e[0],l=e[1],c=e[2],p=0,h=[];p<r.length;p++)n=r[p],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&h.push(s[n][0]),s[n]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);d&&d(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],o=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(o=!1)}o&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var o={},s={app:0},i=[];function n(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=o,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0058":function(t,e,a){t.exports=a.p+"img/balance2.b4f65da4.png"},"0131":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAABwUlEQVRYR+2YPUtcQRSGnxf8BBFsgkWKFMFUQgQLiwTSiBaG2FjY24T4A7RLlz9gkcLa1i0SSIiFGIt0WtgkBEwhqGARcMElCCccuRt2l70um5lltpjp7r1z3vvcd84w51wBmNkQMAVMAqN+r8txA1wAPyT96TL23ukys2Hg+X+CtYo76EFMSAecBh5F/OpTSSex9BxwHhiJJQjUJH2JpeeAS4BiCXpKS/oQS88BX8YSK3QyYKihPXNwFvAdPR5IaMBZgMYVsC/po2t4Dr4CNoC5ANFehFaAFQfcAVZ78YYImm8d8BJ4EEGsFxK/HNBzpm9HBgxdmuxgdjDUgdD4nIMlDtaAbeBz8XwBWGtXOKdwsOo9kKTjRngzewp8BcYa76cAfC3pfTtnzewNsJUacELS7xJAb3vPUwMOSrotAfTmzVvXfyPFEnv+HZYAPivyMCngt2KTNLloZgMFXFPhnMJBd2cPWJf03S/M7AngG+dFq7OpAOsc9d7lYdmJkxqw40mYATta1GFCdjA7GOpAaLzn4HVriRMqGjG+6oC7wHJE0ZhSFQd8DBz1oYte2M7c/fotIN8Bi30A6mCfgE1JP/8CDSPg3wz3pPkAAAAASUVORK5CYII="},"034f":function(t,e,a){"use strict";a("85ec")},1:function(t,e){},"1a5e":function(t,e,a){t.exports=a.p+"img/car1.d0daa8cb.png"},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);var o=a("2b0e"),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{class:t.isIndex?"bodybg1":"bodybg2",attrs:{id:"app"}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showHeader,expression:"showHeader"}],staticStyle:{width:"100%"}},[o("div",{staticClass:"head"},[o("img",{staticStyle:{width:"50px",height:"50px",display:"none"},attrs:{src:t.pools.logo,alt:""}}),o("p",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.coinName))]),o("div",{staticClass:"item",style:2==t.tab&&{fontWeight:"400"},on:{click:function(e){return t.goIndex("/")}}},[t._v(" 首页 "),o("span",{directives:[{name:"show",rawName:"v-show",value:1==t.tab,expression:"tab==1"}]})]),o("div",{staticClass:"item",style:1==t.tab&&{fontWeight:"400"},on:{click:t.goPools}},[t._v(" 矿池 "),o("span",{directives:[{name:"show",rawName:"v-show",value:2==t.tab,expression:"tab==2"}]})]),o("img",{staticStyle:{width:"20px",height:"20px"},attrs:{src:a("0131")},on:{click:function(e){t.showWallet=!0}}})])]),o("van-overlay",{attrs:{show:t.showWallet},on:{click:function(e){t.showWallet=!1}}},[o("div",{staticClass:"card"},[o("div",{staticClass:"wallet",on:{click:function(t){t.stopPropagation()}}},[o("h3",{staticStyle:{color:"rgb(50,77,86)","text-align":"center","font-size":"18","font-weight":"bold"}},[t._v("我的钱包")]),o("h1",{staticStyle:{color:"rgb(50,77,86)","text-align":"center","font-size":"28","font-weight":"bold","margin-top":"30px","margin-bottom":"40px","word-break":"break-all"}},[t._v(t._s(t.balance))]),o("div",{staticClass:"dialogBtn",on:{click:t.toTronScan}},[t._v(" 在TronScan查看 ")]),o("div",{staticClass:"dialogBtn1",on:{click:function(e){t.showWallet=!1}}},[t._v(" 返回页面 ")])])])]),o("keep-alive",{attrs:{include:"Home"}},[o("router-view")],1)],1)},i=[],n=a("d01b"),r=a.n(n),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"home"},[o("div",{staticStyle:{padding:"0 15px","box-sizing":"border-box"}},[t._l(t.text1,(function(e,a){return o("p",{key:a,staticStyle:{color:"#ffffff","text-align":"center","font-family":"Arial, Helvetica, sans-serif","font-size":"18px","font-weight":"bold"},domProps:{innerHTML:t._s(e)}})})),o("p",{staticStyle:{color:"#FFFFFF","text-align":"center","font-size":"16px","margin-top":"12px"}},[t._v(t._s(t.text3))]),o("div",{staticClass:"indexbtnView"},[o("div",{staticClass:"indexBtn",on:{click:t.goPool}},[t._v(" 开始挖矿 ")]),o("div",{staticClass:"indexBtn",on:{click:t.toJustSwap}},[t._v(" "+t._s(t.coinName)+"交易 ")])]),o("div",{staticStyle:{"border-radius":"10px",overflow:"hidden","margin-top":"30px",border:"1px solid #FFFFFF","box-shadow":"0px 0px 10px rgba(152, 152, 152, 0.2)"}},[o("div",{staticStyle:{height:"70px","background-color":"#FFFFFF",padding:"10px",display:"flex","align-items":"center"}},[o("img",{staticStyle:{height:"44px",display:"inline-block"},attrs:{src:a("1a5e"),alt:""}}),o("div",{staticStyle:{display:"inline-block","margin-left":"10px"}},[o("p",{staticStyle:{"font-size":"16px","font-weight":"600"}},[t._v("矿池余量")]),o("p",{staticStyle:{float:"left",color:"rgb(76,48,27)","font-size":"26px","font-weight":"bold"}},[t._v(" "+t._s((t.total-t.allStock).toFixed(4))+" ")])])]),o("div",{staticStyle:{height:"40px","background-color":"#F6B319",color:"#FFFFFF",display:"flex","justify-content":"space-between",padding:"0 10px","align-items":"center"}},[o("div",[t._v("矿产总量")]),o("div",{staticStyle:{float:"right"}},[t._v(t._s(t.total))])])]),o("div",{staticStyle:{"border-radius":"10px",overflow:"hidden","margin-top":"30px",border:"1px solid #FFFFFF","box-shadow":"0px 0px 10px rgba(152, 152, 152, 0.2)"}},[o("div",{staticStyle:{height:"70px","background-color":"#FFFFFF",padding:"10px",display:"flex","align-items":"center"}},[o("img",{staticStyle:{width:"44px",height:"44px",display:"inline-block"},attrs:{src:a("0058"),alt:""}}),o("div",{staticStyle:{display:"inline-block","margin-left":"10px"}},[o("p",{staticStyle:{"font-size":"16px","font-weight":"600"}},[t._v("我的余额")]),o("p",{staticStyle:{float:"left",color:"rgb(76,48,27)","font-size":"26px","font-weight":"bold"}},[t._v(" "+t._s(t.balance)+" ")])])]),o("div",{staticStyle:{width:"100%",height:"60px","background-color":"#F6B319",color:"#FFFFFF",display:"flex"}},[o("div",{staticStyle:{width:"50%",height:"100%",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[o("p",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.unfinishedIncome))]),o("p",{staticStyle:{"font-size":"14px"}},[t._v("待提取收益")])]),o("div",{staticStyle:{width:"50%",height:"100%",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[o("p",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[t._v(t._s(t.allRefReward))]),o("p",{staticStyle:{"font-size":"14px"}},[t._v("贡献奖励")])])])]),o("div",{staticStyle:{"box-shadow":"0px 0px 10px rgba(152, 152, 152, 0.2)","border-radius":"10px","margin-top":"30px",padding:"12px",overflow:"hidden",border:"1px solid rgb(255, 255, 255)"}},[t._m(0),o("div",{staticClass:"copylinkView"},[t._v(" "+t._s(t.refLink1)+" "),o("p",{staticClass:"copylinkView_hide",attrs:{id:"text"}},[t._v(t._s(t.refLink))])]),o("div",{ref:"copy",staticClass:"copyBtn",attrs:{"data-clipboard-action":"copy","data-clipboard-target":"#text"},on:{click:t.copyLink}},[t._v(" 复制链接 ")])])],2),o("van-overlay",{attrs:{show:t.showLoading}},[o("div",{staticStyle:{width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column"}},[o("div",{staticStyle:{width:"240px",height:"130px",background:"#FFFFFF",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column","border-radius":"10px"}},[o("van-loading",{attrs:{type:"circular",color:"#BF211A"}}),o("span",{staticStyle:{color:"#333","font-weight":"bold","margin-top":"6","margin-bottom":"17px","font-size":"16px"}},[t._v("数据链接中……")]),o("span",{staticStyle:{color:"#333","font-size":"14px"}},[t._v("请在钱包中切换波场链打开……")])],1)])])],1)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"inviteTitle",staticStyle:{"padding-left":"64px"}},[a("span",{staticStyle:{"font-size":"18px",color:"rgb(50, 77, 86)","font-weight":"600"}},[t._v("邀请好友")]),a("br"),a("span",{staticStyle:{"font-size":"12px",color:"rgb(50, 77, 86)","margin-top":"-10px"}},[t._v("邀请好友来挖矿你可以获得他收益10%的奖励")])])}],d={name:"Home",data(){return{copyBtn:null,balance:0,parent:"",refLink:"",refLink1:"",unfinishedIncome:0,allRefReward:0,allStock:0,rewardRates:[],starttimes:[],total:0,showLoading:!1,lpTotal:0,text1:wordContent.text1,text2:wordContent.text2,text3:wordContent.text3,coinName:wordContent.coinName}},components:{},async mounted(){window.changeBgcolor&&window.changeBgcolor(!0),window.changeHeader&&window.changeHeader(!0),this.showLoading=!0,this.parent=this.$route.query.ref,this.copyBtn=new this.clipboard(this.$refs.copy);var t=setInterval(async()=>{if("undefined"!==typeof tronWeb){tronWeb.isAddress(this.parent)?localStorage.setItem("parent",this.parent):localStorage.setItem("parent",wordContent.inviteAddres),this.tronWeb=new r.a({fullHost:"http://old.cook.surf/api"}),this.tronWeb.setAddress(tronWeb.defaultAddress.base58),clearInterval(t);let e=await this.tronWeb.contract().at(pools.produceCoin);this.balance=await e.balanceOf(tronWeb.defaultAddress.base58).call(),this.balance=parseFloat(this.balance/pools.decimals).toFixed(5),this.balance=this.balance.substring(0,this.balance.lastIndexOf(".")+5),this.refLink=pools.domain+"?ref="+tronWeb.defaultAddress.base58,this.refLink1=`${pools.domain}_${tronWeb.defaultAddress.base58.slice(0,4)}****${tronWeb.defaultAddress.base58.slice(-3)}`,this.getData(),await this.getStock(),this.showLoading=!1,this.setStock()}},100)},methods:{goPool(){window.changeBgcolor(!0,2),this.$router.push("/pools")},toJustSwap(){window.location.href=wordContent.dexUrl},copyLink(){let t=this,e=t.copyBtn;e.on("success",(function(){alert("成功"),t.copyBtn.destroy(),t.copyBtn=new t.clipboard(t.$refs.copy)})),e.on("error",(function(){alert("失败"),t.copyBtn.destroy(),t.copyBtn=new t.clipboard(t.$refs.copy)}))},async getStock(){for(let t=0;t<pools.pools.length;t++){let e=await this.tronWeb.contract().at(pools.pools[t].mine);this.rewardRates.push(e.rewardRate().call()),this.starttimes.push(e.startTime().call())}},setStock(){var t=this;Promise.all(t.rewardRates.concat(t.starttimes)).then((function(e){var a=Math.round(new Date/1e3);t.allStock=0;for(let o=0;o<e.length/2;o++){let s=(1.1*parseFloat((a-e[e.length/2+o])*e[o]/pools.pools[o].productDecimal)).toFixed(4);"TRX-TKB LP矿池"==pools.pools[o].name&&(console.log("查看stock@@@@@"),console.log(s)),parseFloat(s)<0?pools.pools[o].stock=0:parseFloat(s)>parseFloat(pools.pools[o].total)?pools.pools[o].stock=pools.pools[o].total:pools.pools[o].stock=s,t.allStock=(parseFloat(t.allStock)+parseFloat(pools.pools[o].stock)).toFixed(4)}})),setInterval((function(){Promise.all(t.rewardRates.concat(t.starttimes)).then((function(e){var a=Math.round(new Date/1e3);t.allStock=0;for(let o=0;o<e.length/2;o++){let s=(1.1*parseFloat((a-e[e.length/2+o])*e[o]/pools.pools[o].productDecimal)).toFixed(4);parseFloat(s)<0?pools.pools[o].stock=0:parseFloat(s)>parseFloat(pools.pools[o].total)?pools.pools[o].stock=pools.pools[o].total:pools.pools[o].stock=s,t.allStock=(parseFloat(t.allStock)+parseFloat(pools.pools[o].stock)).toFixed(4)}}))}),1e3)},async getData(){let t=[];for(let i=0;i<pools.pools.length;i++)t.push(await this.tronWeb.contract().at(pools.pools[i].mine));let e=[],a=[],o=[];for(let i=0;i<t.length;i++)e.push(t[i].earned(tronWeb.defaultAddress.base58).call()),a.push(t[i].getReferralRewards(tronWeb.defaultAddress.base58).call()),o.push(t[i].poolInfo().call());var s=this;Promise.all(e).then((function(t){var e=s;t.forEach((t,a)=>{e.unfinishedIncome=e.unfinishedIncome+parseInt(t)/pools.pools[a].productDecimal}),e.unfinishedIncome=parseFloat(e.unfinishedIncome).toFixed(4)})),Promise.all(a).then((function(t){var e=s;t.forEach((t,a)=>{e.allRefReward=e.allRefReward+parseInt(t)/pools.pools[a].productDecimal}),e.allRefReward=parseFloat(e.allRefReward).toFixed(4)})),Promise.all(o).then((function(t){var e=s;for(let a=0;a<t.length;a++)e.total=e.total+parseInt(t[a].totalReward)/pools.pools[a].productDecimal,pools.pools[a].total=parseFloat(t[a].totalReward/pools.pools[a].productDecimal).toFixed(4);e.total=parseFloat(e.total).toFixed(4)}))}}},p=d,h=(a("7297"),a("2877")),g=Object(h["a"])(p,l,c,!1,null,"330cdf1a",null),u=g.exports,f={name:"App",data(){return{balance:0,showWallet:!1,tronScanUrl:"",tronWeb:null,pools:pools,isIndex:!0,tab:1,showHeader:!0,coinName:wordContent.coinName}},mounted(){this.parent=this.$route.query.ref,this.changeBg("pool"!==this.$route.name);const t=this;window.changeBgcolor=function(e,a){t.changeBg(e,a)},window.changeHeader=function(e){t.showHeaderFn(e)};var e=setInterval(async()=>{if("undefined"!==typeof tronWeb){this.tronWeb=new r.a({fullHost:"http://old.cook.surf/api"}),this.tronWeb.setAddress(tronWeb.defaultAddress.base58),clearInterval(e);let t=await this.tronWeb.contract().at(pools.produceCoin);this.balance=await t.balanceOf(tronWeb.defaultAddress.base58).call(),this.balance=parseFloat(this.balance/pools.decimals).toFixed(5),this.balance=this.balance.substring(0,this.balance.lastIndexOf(".")+5),this.tronScanUrl="https://tronscan.org/#/address/"+tronWeb.defaultAddress.base58,tronWeb.isAddress(this.parent)?localStorage.setItem("parent",this.parent):localStorage.setItem("parent",wordContent.inviteAddres)}},100)},methods:{goPools(){this.isIndex=!0,this.tab=2,this.$router.push("/pools")},goIndex(){this.isIndex=!0,this.tab=1,this.$router.replace("/")},toTronScan(){window.location.href=this.tronScanUrl},changeBg(t,e){this.isIndex=t,e&&(this.tab=e)},showHeaderFn(t){this.showHeader=t}}},w=f,x=(a("034f"),Object(h["a"])(w,s,i,!1,null,null,null)),m=x.exports,b=a("8c4f"),v=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"pools"},[o("div",{staticStyle:{display:"flex","flex-wrap":"wrap",width:"100%"}},t._l(t.pools,(function(e,s){return o("div",{key:s,staticClass:"pool_card"},[o("div",{staticClass:"poolItemNumView"},[o("p",{staticClass:"poolItemNum"},[t._v(t._s(s+1)+"号矿池"+t._s("（产"+(e.productName||"")+"）"))])]),o("div",{staticStyle:{height:"30px"}}),o("div",{staticStyle:{display:"flex","justify-content":"center","align-items":"center","margin-bottom":"18px"}},[o("img",{staticStyle:{width:"74px",height:"74px","border-radius":"54px",overflow:"hidden","flex-shrink":"0"},attrs:{src:e.pledgeImage,alt:""}}),o("div",{staticClass:"poolItemInfo"},[o("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"13px"}},[o("p",{staticStyle:{"font-size":"18px","font-weight":"bold","line-height":"24px"}},[t._v(t._s(e.pledgeName))]),o("img",{staticStyle:{width:"20px",height:"10px",margin:"0 9px"},attrs:{src:a("5712")}}),o("p",{staticStyle:{"font-size":"18px","font-weight":"bold","line-height":"24px"}},[t._v(t._s(e.productName))])]),o("p",{staticStyle:{"font-size":"14px",color:"#BF211A"}},[t._v(" 每日产量 "),o("span",{staticStyle:{"font-size":"16px","font-weight":"bold",color:"#BF211A","padding-left":"5px"}},[t._v(t._s(t.getDayValue(e)))])])])]),o("div",{staticClass:"poollistBtn",on:{click:function(a){return t.goDetail(e,s)}}},[t._v(" 进入矿池 ")]),o("div",{staticClass:"poolNumView"},[o("div",{staticStyle:{"font-size":"16px","text-align":"center"}},[t._v("矿池存量:")]),o("h4",{staticStyle:{"text-align":"center","font-size":"28px","font-weight":"bold","line-height":"37px"}},[t._v(t._s(3==t.showendTime(e)?0:(e.total-e.stock).toFixed(4)))])]),o("div",{staticClass:"poolStatusView"},[1==t.showendTime(e)?o("p",[t._v("挖矿还没有开始")]):t._e(),2==t.showendTime(e)?o("div",{staticClass:"cutdownView"},[o("span",[t._v("正在产矿中：")]),o("cutDown",{attrs:{time:e.endTime,poolIndex:s},on:{onEnd:t.endFnc}}),o("span",[t._v("之后挖完")])],1):t._e(),3==t.showendTime(e)?o("p",[t._v("挖矿已经结束了")]):t._e()])])})),0),o("div",{staticStyle:{height:"50px"}})])},y=[],F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{staticClass:"timeTxt"},[a("span",[t._v(t._s(t.day)+"天")]),a("span",[t._v(t._s(t.hour)+"时")]),a("span",[t._v(t._s(t.minte)+"分")]),a("span",[t._v(t._s(t.second)+"秒")])])},S=[],A={name:"cutDown",props:["time","poolIndex"],data(){return{day:0,hour:0,minte:0,second:0,clock:null}},methods:{setCutdown(t){var e=this;this.clock=setInterval(()=>{if(t--,t>0){let a=Math.floor(t/86400),o=Math.floor(t/3600%24),s=Math.floor(t/60%60),i=Math.floor(t%60);e.day=a,e.hour=o,e.minte=s,e.second=i}else clearInterval(e.clock),e.$emit("onEnd",e.poolIndex)},1e3)}},mounted(){const t=Math.floor((new Date(this.time).getTime()-(new Date).getTime())/1e3);this.setCutdown(t)},destroyed(){}},_=A,k=(a("b9b0"),Object(h["a"])(_,F,S,!1,null,"236298c2",null)),B=k.exports,C={name:"Pools",components:{cutDown:B},data(){pools.pools.map(t=>({...t,status:this.showendTime(t)}));return{pools:pools.pools,statusInfo:"正在出矿"}},methods:{getDayValue(t){const e=new Date(t.endTime).getTime()-new Date(t.startTime).getTime(),a=e/24/60/60/1e3;return(t.total/a).toFixed(4)},endFnc(t){this.pools[t].status=3},goDetail(t,e){const a=this.showendTime(t);1!=a?this.$router.push("/pool/"+e):alert("挖矿未开始!")},showendTime(t){const{startTime:e,endTime:a}=t;var o="1";const s=1*(new Date).getTime(),i=1*new Date(a).getTime(),n=1*new Date(e).getTime();return s<n&&(o="1"),n<s&&s<i&&(o="2"),s>i&&(o="3"),o}},async mounted(){window.changeBgcolor&&window.changeBgcolor(!0),window.changeHeader&&window.changeHeader(!0)}},I=C,R=(a("d93e"),Object(h["a"])(I,v,y,!1,null,"3fa5df90",null)),N=R.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pool",staticStyle:{padding:"0 15px","box-sizing":"border-box"}},[a("div",{staticClass:"detailHeader"},[a("div",{staticClass:"backBtn",on:{click:t.backPage}}),a("p",[t._v(t._s(t.poolName))])]),a("div",{staticStyle:{display:"flex","flex-wrap":"wrap",width:"100%",margin:"30px auto","justify-content":"center"}},[a("div",{staticClass:"pool_card"},[a("img",{staticStyle:{width:"50px",height:"50px",display:"block",margin:"0 auto","margin-top":"20px"},attrs:{src:t.pools.pools[this.$route.params.index].productImage}}),a("p",{staticStyle:{"font-size":"14px",color:"#333","margin-top":"14px"}},[t._v(t._s(t.pledgeName)+"挖矿收益")]),a("h2",{staticStyle:{"margin-top":"10px"}},[t._v(t._s(t.earned))]),a("div",{class:0==t.earned?"disable_btn":"enable_btn",staticStyle:{color:"#FFFFFF","line-height":"50px","font-weight":"bold",height:"50px",width:"90%","text-align":"center","border-radius":"5px","box-shadow":"rgba(213, 213, 213, 0.5) 0px 0px 8px",margin:"0 auto","margin-top":"20px","margin-bottom":"30px",cursor:"pointer"},on:{click:t.exit}},[t._v(" 提现 ")])]),a("div",{staticClass:"pool_card"},[a("img",{staticStyle:{width:"50px",height:"50px",display:"block",margin:"0 auto","margin-top":"20px"},attrs:{src:t.pools.pools[this.$route.params.index].productImage}}),a("p",{staticStyle:{"font-size":"14px",color:"#333","margin-top":"14px"}},[t._v(t._s(t.pledgeName)+"推广收益")]),a("h2",{staticStyle:{"margin-top":"10px"}},[t._v(t._s(t.refReward))]),a("div",{class:0==t.refReward?"disable_btn":"enable_btn",staticStyle:{color:"#FFFFFF","line-height":"50px","font-weight":"bold",height:"50px",width:"90%","text-align":"center","border-radius":"5px","box-shadow":"rgba(213, 213, 213, 0.5) 0px 0px 8px",margin:"0 auto","margin-top":"20px","margin-bottom":"30px",cursor:"pointer"},on:{click:t.showRefWithdrawCard}},[t._v(" 提现 ")])]),a("div",{staticClass:"pool_card"},[a("img",{staticStyle:{width:"50px",height:"50px",display:"block",margin:"0 auto","margin-top":"20px"},attrs:{src:t.pools.pools[this.$route.params.index].pledgeImage}}),a("p",{staticStyle:{"font-size":"14px",color:"#333","margin-top":"14px"}},[t._v(t._s(t.pledgeName)+"已质押")]),a("h2",{staticStyle:{"margin-top":"10px"}},[t._v(t._s(t.alreadyBalance))]),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isApprove,expression:"!isApprove"}],staticStyle:{background:"#BF211A",color:"#FFFFFF","line-height":"50px","font-weight":"bold",height:"50px",width:"90%","text-align":"center","border-radius":"5px","box-shadow":"rgba(213, 213, 213, 0.5) 0px 0px 8px",margin:"0 auto","margin-top":"20px","margin-bottom":"30px",cursor:"pointer"},on:{click:t.approve}},[t._v(" 开启挖矿 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isApprove,expression:"isApprove"}],staticStyle:{display:"flex","justify-content":"center","margin-top":"19px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!isNaN(1*t.alreadyBalance)&&1*t.alreadyBalance,expression:"(isNaN(alreadyBalance * 1)?false:(alreadyBalance * 1))"}],staticClass:"cancelBtn",on:{click:function(e){t.showWithdraw=!0}}},[t._v("取消质押")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!isNaN(1*t.alreadyBalance)&&1*t.alreadyBalance,expression:"(isNaN(alreadyBalance * 1)?false:(alreadyBalance * 1))"}],staticClass:"zhiyaBtn",on:{click:t.showDepositdialog}},[t._v("+")]),a("div",{directives:[{name:"show",rawName:"v-show",value:!(!isNaN(1*t.alreadyBalance)&&1*t.alreadyBalance),expression:"!(isNaN(alreadyBalance * 1)?false:(alreadyBalance * 1))"}],staticClass:"cancelBtn",staticStyle:{"margin-right":"0"},on:{click:t.showDepositdialog}},[t._v("质押")])])])]),a("van-overlay",{attrs:{show:t.showDeposit},on:{click:function(e){t.showDeposit=!1}}},[a("div",{staticStyle:{width:"94%",height:"180px","background-color":"#FFFFFF",position:"fixed",bottom:"0","border-radius":"10px 10px 0px 0px","box-shadow":"#CCC 0px 0px 8px",padding:"3%"},on:{click:function(t){t.stopPropagation()}}},[a("h3",{staticStyle:{color:"rgb(50,77,86)","text-align":"center"}},[t._v("质押"+t._s(t.pledgeName))]),a("p",{staticStyle:{"text-align":"right",color:"rgb(50,77,86)","font-size":"14px","margin-top":"10px"}},[t._v(t._s(t.balance)+" "+t._s(t.pledgeName)+"可用")]),a("van-field",{staticStyle:{"margin-top":"10px"},attrs:{type:"number",placeholder:"请输入质押数量"},model:{value:t.depostAmount,callback:function(e){t.depostAmount=e},expression:"depostAmount"}}),a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{color:"#FFFFFF","font-size":"15px","line-height":"40px","font-weight":"400",height:"40px",width:"40%","text-align":"center","border-radius":"5px",background:"#BF211A",margin:"0 auto","margin-top":"20px",cursor:"pointer"},on:{click:function(e){t.showDeposit=!1}}},[t._v(" 取消 ")]),a("div",{staticStyle:{color:"#FFFFFF","font-size":"15px","line-height":"40px","font-weight":"400",height:"40px",width:"40%","text-align":"center","border-radius":"5px",background:"#BF211A",margin:"0 auto","margin-top":"20px",cursor:"pointer"},on:{click:function(e){return t.deposit()}}},[t._v(" 确定 ")])])],1)]),a("van-overlay",{attrs:{show:t.showWithdraw},on:{click:function(e){t.showWithdraw=!1}}},[a("div",{staticStyle:{width:"94%",height:"180px","background-color":"#FFFFFF",position:"fixed",bottom:"0","border-radius":"10px 10px 0px 0px","box-shadow":"#CCC 0px 0px 8px",padding:"3%"},on:{click:function(t){t.stopPropagation()}}},[a("h3",{staticStyle:{color:"rgb(50,77,86)","text-align":"center"}},[t._v("解押"+t._s(t.pledgeName))]),a("p",{staticStyle:{"text-align":"right",color:"rgb(50,77,86)","font-size":"14px","margin-top":"10px"}},[t._v(t._s(t.alreadyBalance)+" "+t._s(t.pledgeName)+"可解押")]),a("van-field",{staticStyle:{"margin-top":"10px"},attrs:{type:"number",placeholder:"请输入解押数量"},model:{value:t.withdrawAmount,callback:function(e){t.withdrawAmount=e},expression:"withdrawAmount"}}),a("div",{staticStyle:{display:"flex"}},[a("div",{staticStyle:{color:"#FFFFFF","font-size":"15px",height:"40px","line-height":"40px",width:"40%","text-align":"center","border-radius":"5px",background:"#BF211A",margin:"0 auto","margin-top":"20px",cursor:"pointer"},on:{click:function(e){t.showWithdraw=!1}}},[t._v(" 取消 ")]),a("div",{staticStyle:{color:"#FFFFFF","font-size":"15px",height:"40px","line-height":"40px",width:"40%","text-align":"center","border-radius":"5px",background:"#BF211A",margin:"0 auto","margin-top":"20px",cursor:"pointer"},on:{click:function(e){return t.withdraw()}}},[t._v(" 解押 ")])])],1)]),a("van-overlay",{attrs:{show:t.showLoading}},[a("div",{staticStyle:{width:"100%",height:"100%",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column"}},[a("div",{staticStyle:{width:"180px",height:"130px",background:"#FFFFFF",display:"flex","justify-content":"center","align-items":"center","flex-direction":"column","border-radius":"10px"}},[a("span",{staticStyle:{color:"#333","font-size":"16px","font-weight":"bold","margin-bottom":"15px"}},[t._v("确认中...")]),a("van-loading",{attrs:{type:"circular",color:"#BF211A"}}),a("span",{staticStyle:{color:"#999","font-size":"14","margin-top":"10px"}},[t._v("请稍后...")])],1)])])],1)},T=[],D={name:"Pool",data(){return{poolName:"",pledgeName:"",contractAddress:"",pledgeAddress:"",contract:null,trc20:null,autoContract:null,autoTrc20:null,earned:0,address:"",isApprove:!1,balance:0,alreadyBalance:0,showDeposit:!1,showWithdraw:!1,showRefWithdraw:!1,depostAmount:"",withdrawAmount:"",refWithdrawAmount:"",showLoading:!1,refReward:0,timer:null,pools:pools}},methods:{showDepositdialog(){const t=this.balance,e=1*t;console.log(e),!isNaN(e)&&e&&(this.showDeposit=!0)},backPage(){this.$router.go(-1)},async getData(){console.log("第一行getdata函数");let t=await tronWeb.transactionBuilder.triggerConstantContract(this.pledgeAddress,"balanceOf(address)",{},[{type:"address",value:this.address}],this.address);console.log("balanceRes");let e=t.constant_result[0];this.balance=await this.decodeParams(["uint256"],"0x"+e,!0),console.log("this.balance"),this.balance=parseFloat(this.balance/pools.pools[this.$route.params.index].decimals).toFixed(15),this.balance=this.balance.substring(0,this.balance.lastIndexOf(".")+5),console.log("this.balance",this.balance),this.refReward=await this.contract.getReferralRewards(this.address).call(),this.refReward=parseFloat(this.refReward/pools.pools[this.$route.params.index].productDecimal).toFixed(15),this.refReward=this.refReward.substring(0,this.refReward.lastIndexOf(".")+5);await this.contract.periodFinish().call();let a=await tronWeb.transactionBuilder.triggerConstantContract(this.pledgeAddress,"allowance(address,address)",{},[{type:"address",value:this.address},{type:"address",value:this.contractAddress}],this.address);e=a.constant_result[0];let o=await this.decodeParams(["uint256"],"0x"+e,!0);o>0&&(this.isApprove=!0)},async getEarned(){this.earned=await this.contract.earned(this.address).call(),this.earned=parseFloat(this.earned/pools.pools[this.$route.params.index].productDecimal).toFixed(15),this.earned=this.earned.substring(0,this.earned.lastIndexOf(".")+5),this.alreadyBalance=await this.contract.balanceOf(this.address).call(),this.alreadyBalance=parseFloat(this.alreadyBalance/pools.pools[this.$route.params.index].decimals).toFixed(15),this.alreadyBalance=this.alreadyBalance.substring(0,this.alreadyBalance.lastIndexOf(".")+5),this.timer=setInterval(async()=>{this.$route.params.index?(this.earned=await this.contract.earned(this.address).call(),this.earned=parseFloat(this.earned/pools.pools[this.$route.params.index].productDecimal).toFixed(15),this.earned=this.earned.substring(0,this.earned.lastIndexOf(".")+5),this.alreadyBalance=await this.contract.balanceOf(this.address).call(),this.alreadyBalance=parseFloat(this.alreadyBalance/pools.pools[this.$route.params.index].decimals).toFixed(15),this.alreadyBalance=this.alreadyBalance.substring(0,this.alreadyBalance.lastIndexOf(".")+5)):(console.log("clear"),clearInterval(this.timer))},2e3)},async approve(){try{let e=await tronWeb.transactionBuilder.triggerSmartContract(this.pledgeAddress,"approve(address,uint256)",{},[{type:"address",value:this.contractAddress},{type:"uint256",value:"100000000000000000000000000"}],this.address),a=await tronWeb.trx.sign(e.transaction);fetch("/api/wallet/broadcasttransaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(t){console.log(t)}));var t=setInterval(async()=>{let e=await this.tronWeb.transactionBuilder.triggerConstantContract(this.pledgeAddress,"allowance(address,address)",{},[{type:"address",value:this.address},{type:"address",value:this.contractAddress}],this.address),a=e.constant_result[0],o=await this.decodeParams(["uint256"],"0x"+a,!0);o>0&&(this.isApprove=!0,clearInterval(t))},2e3)}catch(e){console.log(e)}},async deposit(){let t=await this.contract.periodFinish().call();if(Math.round(new Date/1e3)<t)try{this.showLoading=!0;let t=this.multiplication(this.depostAmount,pools.pools[this.$route.params.index].decimals);var e=localStorage.getItem("parent");tronWeb.isAddress(e)||(e=wordContent.inviteAddres);var a=await this.autoContract.deposit(String(t),e).send();console.log("???res",a);var o=this;this.getTransaction(a,(function(){setTimeout(()=>{o.getData()},1e3)}),(function(){alert("交易失败！")})),this.showDeposit=!1,this.showLoading=!1}catch(s){console.log("取消",s),this.showLoading=!1,alert("交易已取消")}else alert("挖矿结束")},async withdraw(){try{this.showLoading=!0;let a=this.multiplication(this.withdrawAmount,pools.pools[this.$route.params.index].decimals);var t=await this.autoContract.withdraw(String(a)).send();console.log(t);var e=this;this.getTransaction(t,(function(){setTimeout(()=>{e.getData()},1e3)}),(function(){alert("交易失败！")})),this.showWithdraw=!1,this.showLoading=!1}catch(a){alert("交易已取消！"),this.showLoading=!1}},multiplication(t,e){if(""!=t&&""!=e){const a=window.tronWeb.BigNumber(t),o=window.tronWeb.BigNumber(e);return a.multipliedBy(o).toString()}return 0},async withdrawReferralRewards(){if(0!=this.refReward)try{this.showLoading=!0;let a=this.multiplication(this.refReward,pools.pools[this.$route.params.index].productDecimal);var t=await this.autoContract.withdrawReferralRewards(a).send();console.log(t);var e=this;this.getTransaction(t,(function(){setTimeout(()=>{e.getData()},1e3)}),(function(){alert("交易失败！")})),this.showRefWithdraw=!1,this.showLoading=!1}catch(a){alert("交易已取消！"),this.showLoading=!1}},async exit(){if(console.log(sessionStorage.getItem("INVITEVAL")),0!=this.earned)try{this.showLoading=!0;let e=await this.autoContract.getReward().send();console.log(e);var t=this;t=this;this.getTransaction(e,(function(){setTimeout(()=>{t.getData()},1e3)}),(function(){alert("交易失败！")})),this.showLoading=!1}catch(e){alert("交易已取消！"),this.showLoading=!1}},getTransaction(t,e,a){window.tronWeb.fullNode.request("wallet/gettransactioninfobyid",{value:t},"post").then(o=>{Object.keys(o).length?"SUCCESS"==(o.receipt&&o.receipt.result)?e():a():setTimeout(()=>{this.getTransaction(t,e,a)},3e3)})},showRefWithdrawCard(){0!=this.refReward&&this.withdrawReferralRewards()},async encodeParams(t){const e=this.ethers.utils.AbiCoder,a=/^(41)/;let o=t,s="";if(0==o.length)return s;const i=new e;let n=[];const r=[];for(let c=0;c<o.length;c++){let{type:t,value:e}=o[c];"address"==t?e=e.replace(a,"0x"):"address[]"==t&&(e=e.map(t=>toHex(t).replace(a,"0x"))),n.push(t),r.push(e)}console.log(n,r);try{s=i.encode(n,r).replace(/^(0x)/,"")}catch(l){console.log(l)}return s},async decodeParams(t,e,a){const o=this.ethers.utils.AbiCoder,s="41";e&&"boolean"!==typeof e||(a=e,e=t),a&&e.replace(/^0x/,"").length%64===8&&(e="0x"+e.replace(/^0x/,"").substring(8));const i=new o;if(e.replace(/^0x/,"").length%64)throw new Error("The encoded string is not valid. Its length must be a multiple of 64.");return i.decode(t,e).reduce((e,a,o)=>("address"==t[o]&&(a=s+a.substr(2).toLowerCase()),e.push(a),e),[])}},mounted(){window.changeBgcolor&&window.changeBgcolor(!1),window.changeHeader&&window.changeHeader(!1),this.contractAddress=pools.pools[this.$route.params.index].mine,this.pledgeAddress=pools.pools[this.$route.params.index].pledgeAddress,this.poolName=pools.pools[this.$route.params.index].name,this.pledgeName=pools.pools[this.$route.params.index].pledgeName;var t=setInterval(async()=>{"undefined"!==typeof tronWeb&&(this.autoContract=await tronWeb.contract().at(this.contractAddress),this.tronWeb=new r.a({fullHost:"http://old.cook.surf/api"}),this.tronWeb.setAddress(tronWeb.defaultAddress.base58),clearInterval(t),this.contract=await this.tronWeb.contract().at(this.contractAddress),this.trc20=await this.tronWeb.contract().at(this.pledgeAddress),this.address=tronWeb.defaultAddress.base58,this.getData(),this.getEarned())},100)},beforeRouteLeave(t,e,a){clearInterval(this.timer),a()},destroyed(){console.log(11111),clearInterval(this.timer)},beforeDestroy(){console.log("des"),clearInterval(this.timer)}},z=D,P=(a("b22b"),Object(h["a"])(z,W,T,!1,null,"368691ed",null)),O=P.exports;o["default"].use(b["a"]);const L=[{path:"/",name:"Home",component:u},{path:"/pools",name:"Pools",component:N},{path:"/pool/:index",name:"Pool",component:O}],j=new b["a"]({mode:"history",base:"/",routes:L});var H=j,$=a("b311"),M=a.n($),E=a("9fdc"),J=a.n(E),V=(a("e815"),a("bb05")),Y=a.n(V),U=(a("fdc4"),a("b988")),Q=a.n(U),K=(a("b657"),a("c030"));o["default"].use(J.a).use(Y.a).use(Q.a),o["default"].prototype.clipboard=M.a,o["default"].prototype.ethers=K,o["default"].config.productionTip=!1,new o["default"]({router:H,render:function(t){return t(m)}}).$mount("#app")},5712:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAAWCAYAAABdTLWOAAAAAXNSR0IArs4c6QAAAXlJREFUSEvF1jFLw0AUB/D3T6wYqHNBHAS3Umh6WQT9APpRRJAKQic3B8FBRTf9Hg4OLo7mQj+A9CM42MWh/OVChRja5irp3S2B3OPdj+S9l0A8rCRJds2xaZp+2BwPm6A6Y5RSJwAepjkv0zS9qMrvFNlut5tRFH2KyNovjOSt1vpsEdQp0uCSJBmJyHYRVQV1jRSl1J6IvABo2kKdIw2s2+0ehGH4bAv1glwW6g25DDRHdjqdVqPR2KgaBavYJ7kfhuGTiESFjheS91mWnZp7UEpdAzhfBcA2J8k8FIDB5VezSN5prfsG+VUuYNvkdcYVoYUnSpItgxwB2KnzwLpykRxrrTcN8hDAgKRP6BaA9dLc/J5MJkfD4fDVa3cblFLqBkC/BBxPgW95rdb1av6TxwboFWkL9IZcBugF2ev1BkEQXC2qwXLpOK3JOf+Tf5pkVm07RZb/J80cLHbxvOZzjZQ4juMgCB6nn73jLMveqyaDc2QVaNb+D3+c07+mFNBIAAAAAElFTkSuQmCC"},"6c8a":function(t,e,a){},7297:function(t,e,a){"use strict";a("b9d1")},"85ec":function(t,e,a){},a67c:function(t,e,a){},b22b:function(t,e,a){"use strict";a("6c8a")},b9b0:function(t,e,a){"use strict";a("a67c")},b9d1:function(t,e,a){},d93e:function(t,e,a){"use strict";a("f07d")},f07d:function(t,e,a){}});
//# sourceMappingURL=app.0e6a117c.js.map